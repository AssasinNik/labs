2025-05-10 14:57:39.385 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - Starting Lab2ApplicationKt using Java 20.0.2.1 with PID 2082 (/Users/nikitacerenkov/Documents/GitHub/labs/lab_2/build/classes/kotlin/main started by nikitacerenkov in /Users/nikitacerenkov/Documents/GitHub/labs)
2025-05-10 14:57:39.387 [main] [] DEBUG c.cherenkov.lab_2.Lab2ApplicationKt - Running with Spring Boot v3.4.4, Spring v6.2.5
2025-05-10 14:57:39.388 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-05-10 14:57:39.991 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 14:57:39.994 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2025-05-10 14:57:40.009 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Elasticsearch repository interfaces.
2025-05-10 14:57:40.013 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 14:57:40.013 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2025-05-10 14:57:40.017 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Reactive Elasticsearch repository interfaces.
2025-05-10 14:57:40.034 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 14:57:40.034 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2025-05-10 14:57:40.037 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 MongoDB repository interfaces.
2025-05-10 14:57:40.051 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 14:57:40.052 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Neo4j repositories in DEFAULT mode.
2025-05-10 14:57:40.055 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Neo4j repository interfaces.
2025-05-10 14:57:40.057 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 14:57:40.057 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Neo4j repositories in DEFAULT mode.
2025-05-10 14:57:40.060 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Neo4j repository interfaces.
2025-05-10 14:57:40.068 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 14:57:40.068 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data R2DBC repositories in DEFAULT mode.
2025-05-10 14:57:40.070 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 R2DBC repository interfaces.
2025-05-10 14:57:40.076 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 14:57:40.077 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-10 14:57:40.083 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-05-10 14:57:40.422 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-05-10 14:57:40.429 [main] [] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-10 14:57:40.429 [main] [] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.39]
2025-05-10 14:57:40.451 [main] [] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-10 14:57:40.451 [main] [] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1043 ms
2025-05-10 14:57:40.478 [main] [] DEBUG c.c.lab_2.filter.GatewayAuthFilter - Filter 'gatewayAuthFilter' configured for use
2025-05-10 14:57:40.478 [main] [] DEBUG c.c.l.configs.RequestLoggingFilter - Filter 'requestLoggingFilter' configured for use
2025-05-10 14:57:40.873 [main] [] INFO  o.n.driver.internal.DriverFactory - Direct driver instance 891215395 created for server address localhost:7687
2025-05-10 14:57:40.946 [main] [] INFO  org.mongodb.driver.client - MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "5.2.1"}, "os": {"type": "Darwin", "name": "Mac OS X", "architecture": "aarch64", "version": "15.3.2"}, "platform": "Java/Amazon.com Inc./20.0.2.1+10-FR"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, transportSettings=null, commandListeners=[], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, CollectionCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.client.model.mql.ExpressionCodecProvider@35cbeb54, com.mongodb.Jep395RecordCodecProvider@a7ae340, com.mongodb.KotlinCodecProvider@5e8bd498]}, loggerSettings=LoggerSettings{maxDocumentLength=1000}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='15 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverMonitoringMode=AUTO, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, dnsClient=null, inetAddressResolver=null, contextProvider=null, timeoutMS=null}
2025-05-10 14:57:40.958 [cluster-ClusterId{value='681f3f34f890251704da839d', description='null'}-localhost:27017] [] INFO  org.mongodb.driver.cluster - Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, cryptd=false, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=25, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=12480667, minRoundTripTimeNanos=0}
2025-05-10 14:57:41.206 [main] [] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-05-10 14:57:41.729 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-05-10 14:57:41.736 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - Started Lab2ApplicationKt in 2.562 seconds (process running for 2.814)
2025-05-10 14:58:27.994 [http-nio-8082-exec-1] [] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-10 14:58:27.995 [http-nio-8082-exec-1] [] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-10 14:58:27.996 [http-nio-8082-exec-1] [] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-10 14:58:27.999 [http-nio-8082-exec-1] [] DEBUG c.cherenkov.lab_1.utils.LoggingUtils - Настроен контекст логирования для запроса bd229a15-cab8-4e95-9ff0-84c80db5c161: пользователь=anonymous, метод=POST, uri=/reports/course
2025-05-10 14:58:28.003 [http-nio-8082-exec-1] [] INFO  c.c.l.configs.RequestLoggingFilter - >>> {POST} {/reports/course}
2025-05-10 14:58:28.014 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.filter.GatewayAuthFilter - Запрос от Gateway на путь: /reports/course
2025-05-10 14:58:28.015 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.filter.GatewayAuthFilter - Аутентифицирован пользователь: kirillik
2025-05-10 14:58:28.091 [http-nio-8082-exec-1] [] INFO  c.c.l.controllers.ReportController - Получен запрос для отчета по курсу: courseId=49, semester=1, studyYear=2023
2025-05-10 14:58:28.092 [http-nio-8082-exec-1] [] INFO  c.c.lab_2.service.ReportService - [72c808c8] Запрос на генерацию отчета: courseId=49, semester=1, studyYear=2023
2025-05-10 14:58:28.092 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Запрос курса из базы данных: courseId=49
2025-05-10 14:58:28.268 [http-nio-8082-exec-1] [] INFO  org.jooq.Constants - 
                                      
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@  @@        @@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@        @@@@@@@@@@
@@@@@@@@@@@@@@@@  @@  @@    @@@@@@@@@@
@@@@@@@@@@  @@@@  @@  @@    @@@@@@@@@@
@@@@@@@@@@        @@        @@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@        @@        @@@@@@@@@@
@@@@@@@@@@    @@  @@  @@@@  @@@@@@@@@@
@@@@@@@@@@    @@  @@  @@@@  @@@@@@@@@@
@@@@@@@@@@        @@  @  @  @@@@@@@@@@
@@@@@@@@@@        @@        @@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Thank you for using jOOQ 3.19.21 (Build date: 2025-03-11T08:47:49Z)
                                      
2025-05-10 14:58:28.269 [http-nio-8082-exec-1] [] INFO  org.jooq.Constants - 

jOOQ tip of the day: Thinking of building a query with jOOQ and executing it elsewhere? Think again: https://blog.jooq.org/why-you-should-execute-jooq-queries-with-jooq/

2025-05-10 14:58:28.291 [http-nio-8082-exec-1] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-10 14:58:28.404 [http-nio-8082-exec-1] [] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@4b83e8fd
2025-05-10 14:58:28.405 [http-nio-8082-exec-1] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-10 14:58:28.409 [http-nio-8082-exec-1] [] INFO  o.j.i.D.logVersionSupport - Version                  : Database version is supported by dialect POSTGRES: 17.5 (Debian 17.5-1.pgdg120+1)
2025-05-10 14:58:28.439 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Курс загружен: id=49, name='Компьютерное зрение', departmentId=10
2025-05-10 14:58:28.439 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Запрос лекций из базы данных: courseId=49
2025-05-10 14:58:28.447 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Загружено 2 лекций для курса 'Компьютерное зрение'
2025-05-10 14:58:28.447 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Запрос ID лекций из Neo4j: semester=1, studyYear=2023
2025-05-10 14:58:28.453 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Выполнение Neo4j запроса:              MATCH (g:Group)-[hs:HAS_SCHEDULE]->(l:Lecture)             WHERE hs.date.year = $year AND (               ($sem = 1 AND hs.date.month >= 9 AND hs.date.month <= 12) OR               ($sem = 2 AND hs.date.month >= 1 AND hs.date.month <= 6)             )             RETURN DISTINCT l.id AS id         , params: {year: 2023, sem: 1}
2025-05-10 14:58:28.885 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Получены ID лекций из Neo4j: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600]
2025-05-10 14:58:28.886 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Найдено 600 лекций, запланированных в семестре 1 года 2023
2025-05-10 14:58:28.886 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Запрос информации об университете из MongoDB: departmentId=10
2025-05-10 14:58:28.890 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Выполнение MongoDB запроса: query=Query: { "institutes.departments.departmentId" : 10}, Fields: {}, Sort: {}
2025-05-10 14:58:28.942 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Получен документ университета: id=681f3ec77343b104f6c75048, name=РТУ МИРЭА
2025-05-10 14:58:28.942 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Документ университета получен: universityId=null, name='РТУ МИРЭА'
2025-05-10 14:58:28.943 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Определен институт='Институт кибербезопасности', кафедра='Кафедра программной инженерии'
2025-05-10 14:58:28.943 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Отфильтровано 2 лекций для отчета
2025-05-10 14:58:28.943 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Обработка лекции id=97 name='Интеграция и масштабирование (Компьютерное зрение)'
2025-05-10 14:58:28.943 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Запрос количества студентов из Neo4j: lectureId=97, semester=1, studyYear=2023
2025-05-10 14:58:28.943 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Выполнение Neo4j запроса:              MATCH (l:Lecture {id: $lid})<-[hs:HAS_SCHEDULE]-(g:Group)<-[:BELONGS_TO]-(s:Student)             WHERE hs.date.year = $year AND (               ($sem = 1 AND hs.date.month >= 9 AND hs.date.month <= 12) OR               ($sem = 2 AND hs.date.month >= 1 AND hs.date.month <= 6)             )             RETURN count(DISTINCT s) AS cnt         , params: {sem: 1, year: 2023, lid: 97}
2025-05-10 14:58:29.100 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Получено количество студентов для лекции 97: 150
2025-05-10 14:58:29.102 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Лекция id=97 имеет studentCount=150
2025-05-10 14:58:29.102 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Обработка лекции id=98 name='Алгоритмы и оптимизация (Компьютерное зрение)'
2025-05-10 14:58:29.102 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Запрос количества студентов из Neo4j: lectureId=98, semester=1, studyYear=2023
2025-05-10 14:58:29.102 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Выполнение Neo4j запроса:              MATCH (l:Lecture {id: $lid})<-[hs:HAS_SCHEDULE]-(g:Group)<-[:BELONGS_TO]-(s:Student)             WHERE hs.date.year = $year AND (               ($sem = 1 AND hs.date.month >= 9 AND hs.date.month <= 12) OR               ($sem = 2 AND hs.date.month >= 1 AND hs.date.month <= 6)             )             RETURN count(DISTINCT s) AS cnt         , params: {sem: 1, year: 2023, lid: 98}
2025-05-10 14:58:29.106 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Получено количество студентов для лекции 98: 150
2025-05-10 14:58:29.108 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [72c808c8] Лекция id=98 имеет studentCount=150
2025-05-10 14:58:29.108 [http-nio-8082-exec-1] [] INFO  c.c.lab_2.service.ReportService - [72c808c8] Отчет успешно сформирован: 2 записей
2025-05-10 14:58:29.108 [http-nio-8082-exec-1] [] INFO  c.c.l.controllers.ReportController - Сформирован отчет, количество записей: 2
2025-05-10 14:58:29.131 [http-nio-8082-exec-1] [] INFO  c.c.l.configs.RequestLoggingFilter - <<< {org.apache.catalina.connector.ResponseFacade@392db59b} - {200} ({1129} мс)
2025-05-10 14:59:15.767 [SpringApplicationShutdownHook] [] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-10 14:59:15.770 [tomcat-shutdown] [] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-10 14:59:15.896 [SpringApplicationShutdownHook] [] INFO  o.n.driver.internal.InternalDriver - Closing driver instance 891215395
2025-05-10 14:59:16.115 [SpringApplicationShutdownHook] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-10 14:59:16.117 [SpringApplicationShutdownHook] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-10 16:08:01.754 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - Starting Lab2ApplicationKt using Java 20.0.2.1 with PID 5198 (/Users/nikitacerenkov/Documents/GitHub/labs/lab_2/build/classes/kotlin/main started by nikitacerenkov in /Users/nikitacerenkov/Documents/GitHub/labs)
2025-05-10 16:08:01.755 [main] [] DEBUG c.cherenkov.lab_2.Lab2ApplicationKt - Running with Spring Boot v3.4.4, Spring v6.2.5
2025-05-10 16:08:01.756 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-05-10 16:08:02.305 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:08:02.306 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2025-05-10 16:08:02.320 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Elasticsearch repository interfaces.
2025-05-10 16:08:02.324 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:08:02.324 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2025-05-10 16:08:02.327 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Reactive Elasticsearch repository interfaces.
2025-05-10 16:08:02.340 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:08:02.340 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2025-05-10 16:08:02.343 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 MongoDB repository interfaces.
2025-05-10 16:08:02.356 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:08:02.356 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Neo4j repositories in DEFAULT mode.
2025-05-10 16:08:02.359 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Neo4j repository interfaces.
2025-05-10 16:08:02.361 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:08:02.362 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Neo4j repositories in DEFAULT mode.
2025-05-10 16:08:02.364 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Neo4j repository interfaces.
2025-05-10 16:08:02.370 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:08:02.371 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data R2DBC repositories in DEFAULT mode.
2025-05-10 16:08:02.373 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 R2DBC repository interfaces.
2025-05-10 16:08:02.379 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:08:02.379 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-10 16:08:02.386 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-05-10 16:08:02.779 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-05-10 16:08:02.788 [main] [] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-10 16:08:02.788 [main] [] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.39]
2025-05-10 16:08:02.817 [main] [] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-10 16:08:02.818 [main] [] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1030 ms
2025-05-10 16:08:02.849 [main] [] DEBUG c.c.lab_2.filter.GatewayAuthFilter - Filter 'gatewayAuthFilter' configured for use
2025-05-10 16:08:02.849 [main] [] DEBUG c.c.l.configs.RequestLoggingFilter - Filter 'requestLoggingFilter' configured for use
2025-05-10 16:08:03.359 [main] [] INFO  o.n.driver.internal.DriverFactory - Direct driver instance 366314800 created for server address localhost:7687
2025-05-10 16:08:03.449 [main] [] INFO  org.mongodb.driver.client - MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "5.2.1"}, "os": {"type": "Darwin", "name": "Mac OS X", "architecture": "aarch64", "version": "15.3.2"}, "platform": "Java/Amazon.com Inc./20.0.2.1+10-FR"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, transportSettings=null, commandListeners=[], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, CollectionCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.client.model.mql.ExpressionCodecProvider@78743dd8, com.mongodb.Jep395RecordCodecProvider@752494dd, com.mongodb.KotlinCodecProvider@2986427e]}, loggerSettings=LoggerSettings{maxDocumentLength=1000}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='15 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverMonitoringMode=AUTO, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, dnsClient=null, inetAddressResolver=null, contextProvider=null, timeoutMS=null}
2025-05-10 16:08:03.453 [cluster-ClusterId{value='681f4fb3eef05007c187a256', description='null'}-localhost:27017] [] INFO  org.mongodb.driver.cluster - Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketReadException: Exception receiving message
	at com.mongodb.internal.connection.InternalStreamConnection.translateReadException(InternalStreamConnection.java:814)
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:862)
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:517)
	at com.mongodb.internal.connection.InternalStreamConnection.sendAndReceiveInternal(InternalStreamConnection.java:448)
	at com.mongodb.internal.connection.InternalStreamConnection.lambda$sendAndReceive$0(InternalStreamConnection.java:375)
	at com.mongodb.internal.connection.InternalStreamConnection.sendAndReceive(InternalStreamConnection.java:378)
	at com.mongodb.internal.connection.CommandHelper.sendAndReceive(CommandHelper.java:100)
	at com.mongodb.internal.connection.CommandHelper.executeCommand(CommandHelper.java:49)
	at com.mongodb.internal.connection.InternalStreamConnectionInitializer.initializeConnectionDescription(InternalStreamConnectionInitializer.java:144)
	at com.mongodb.internal.connection.InternalStreamConnectionInitializer.startHandshake(InternalStreamConnectionInitializer.java:79)
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:235)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.lookupServerDescription(DefaultServerMonitor.java:219)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.run(DefaultServerMonitor.java:176)
Caused by: java.net.SocketException: Connection reset
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:318)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:345)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:794)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:1025)
	at com.mongodb.internal.connection.SocketStream.read(SocketStream.java:182)
	at com.mongodb.internal.connection.InternalStreamConnection.receiveResponseBuffers(InternalStreamConnection.java:829)
	... 11 common frames omitted
2025-05-10 16:08:03.787 [main] [] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-05-10 16:08:04.412 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-05-10 16:08:04.420 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - Started Lab2ApplicationKt in 2.944 seconds (process running for 3.365)
2025-05-10 16:10:03.543 [cluster-ClusterId{value='681f4fb3eef05007c187a256', description='null'}-localhost:27017] [] INFO  org.mongodb.driver.cluster - Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.lambda$open$0(SocketStream.java:85)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:85)
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:233)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.lookupServerDescription(DefaultServerMonitor.java:219)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.run(DefaultServerMonitor.java:176)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:673)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:547)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:590)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:666)
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:76)
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:104)
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:79)
	... 3 common frames omitted
2025-05-10 16:10:24.330 [SpringApplicationShutdownHook] [] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-10 16:10:24.333 [tomcat-shutdown] [] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-10 16:10:24.487 [SpringApplicationShutdownHook] [] INFO  o.n.driver.internal.InternalDriver - Closing driver instance 366314800
2025-05-10 16:15:37.233 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - Starting Lab2ApplicationKt using Java 20.0.2.1 with PID 5353 (/Users/nikitacerenkov/Documents/GitHub/labs/lab_2/build/classes/kotlin/main started by nikitacerenkov in /Users/nikitacerenkov/Documents/GitHub/labs)
2025-05-10 16:15:37.235 [main] [] DEBUG c.cherenkov.lab_2.Lab2ApplicationKt - Running with Spring Boot v3.4.4, Spring v6.2.5
2025-05-10 16:15:37.235 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-05-10 16:15:37.749 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:15:37.750 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
2025-05-10 16:15:37.764 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Elasticsearch repository interfaces.
2025-05-10 16:15:37.768 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:15:37.768 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
2025-05-10 16:15:37.771 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Reactive Elasticsearch repository interfaces.
2025-05-10 16:15:37.788 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:15:37.788 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data MongoDB repositories in DEFAULT mode.
2025-05-10 16:15:37.791 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 MongoDB repository interfaces.
2025-05-10 16:15:37.805 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:15:37.806 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Neo4j repositories in DEFAULT mode.
2025-05-10 16:15:37.809 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Neo4j repository interfaces.
2025-05-10 16:15:37.812 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:15:37.812 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Neo4j repositories in DEFAULT mode.
2025-05-10 16:15:37.815 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Neo4j repository interfaces.
2025-05-10 16:15:37.821 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:15:37.822 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data R2DBC repositories in DEFAULT mode.
2025-05-10 16:15:37.824 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 R2DBC repository interfaces.
2025-05-10 16:15:37.830 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-05-10 16:15:37.830 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-05-10 16:15:37.836 [main] [] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 1 ms. Found 0 Redis repository interfaces.
2025-05-10 16:15:38.227 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-05-10 16:15:38.237 [main] [] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-10 16:15:38.237 [main] [] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.39]
2025-05-10 16:15:38.267 [main] [] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-10 16:15:38.267 [main] [] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1006 ms
2025-05-10 16:15:38.299 [main] [] DEBUG c.c.lab_2.filter.GatewayAuthFilter - Filter 'gatewayAuthFilter' configured for use
2025-05-10 16:15:38.299 [main] [] DEBUG c.c.l.configs.RequestLoggingFilter - Filter 'requestLoggingFilter' configured for use
2025-05-10 16:15:38.783 [main] [] INFO  o.n.driver.internal.DriverFactory - Direct driver instance 1400585185 created for server address localhost:7687
2025-05-10 16:15:38.874 [main] [] INFO  org.mongodb.driver.client - MongoClient with metadata {"driver": {"name": "mongo-java-driver|sync|spring-boot", "version": "5.2.1"}, "os": {"type": "Darwin", "name": "Mac OS X", "architecture": "aarch64", "version": "15.3.2"}, "platform": "Java/Amazon.com Inc./20.0.2.1+10-FR"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, transportSettings=null, commandListeners=[], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, CollectionCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.client.model.mql.ExpressionCodecProvider@6d7e2795, com.mongodb.Jep395RecordCodecProvider@78743dd8, com.mongodb.KotlinCodecProvider@752494dd]}, loggerSettings=LoggerSettings{maxDocumentLength=1000}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='15 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverMonitoringMode=AUTO, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, dnsClient=null, inetAddressResolver=null, contextProvider=null, timeoutMS=null}
2025-05-10 16:15:38.884 [cluster-ClusterId{value='681f517a63663f635d80dc3a', description='null'}-localhost:27017] [] INFO  org.mongodb.driver.cluster - Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, cryptd=false, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=25, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=11411375, minRoundTripTimeNanos=0}
2025-05-10 16:15:39.170 [main] [] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-05-10 16:15:39.804 [main] [] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-05-10 16:15:39.813 [main] [] INFO  c.cherenkov.lab_2.Lab2ApplicationKt - Started Lab2ApplicationKt in 2.805 seconds (process running for 3.13)
2025-05-10 16:16:15.338 [http-nio-8082-exec-1] [] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-10 16:16:15.339 [http-nio-8082-exec-1] [] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-10 16:16:15.340 [http-nio-8082-exec-1] [] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-10 16:16:15.343 [http-nio-8082-exec-1] [] DEBUG c.cherenkov.lab_1.utils.LoggingUtils - Настроен контекст логирования для запроса d62592d8-7752-4334-b3bb-44404e51dce8: пользователь=anonymous, метод=POST, uri=/reports/course
2025-05-10 16:16:15.347 [http-nio-8082-exec-1] [] INFO  c.c.l.configs.RequestLoggingFilter - >>> {POST} {/reports/course}
2025-05-10 16:16:15.357 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.filter.GatewayAuthFilter - Запрос от Gateway на путь: /reports/course
2025-05-10 16:16:15.358 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.filter.GatewayAuthFilter - Аутентифицирован пользователь: kirillik
2025-05-10 16:16:15.449 [http-nio-8082-exec-1] [] INFO  c.c.l.controllers.ReportController - Получен запрос для отчета по курсу: courseId=49, semester=1, studyYear=2023
2025-05-10 16:16:15.449 [http-nio-8082-exec-1] [] INFO  c.c.lab_2.service.ReportService - [0cb65892] Запрос на генерацию отчета: courseId=49, semester=1, studyYear=2023
2025-05-10 16:16:15.449 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Запрос курса из базы данных: courseId=49
2025-05-10 16:16:15.659 [http-nio-8082-exec-1] [] INFO  org.jooq.Constants - 
                                      
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@  @@        @@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@        @@@@@@@@@@
@@@@@@@@@@@@@@@@  @@  @@    @@@@@@@@@@
@@@@@@@@@@  @@@@  @@  @@    @@@@@@@@@@
@@@@@@@@@@        @@        @@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@        @@        @@@@@@@@@@
@@@@@@@@@@    @@  @@  @@@@  @@@@@@@@@@
@@@@@@@@@@    @@  @@  @@@@  @@@@@@@@@@
@@@@@@@@@@        @@  @  @  @@@@@@@@@@
@@@@@@@@@@        @@        @@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  Thank you for using jOOQ 3.19.21 (Build date: 2025-03-11T08:47:49Z)
                                      
2025-05-10 16:16:15.659 [http-nio-8082-exec-1] [] INFO  org.jooq.Constants - 

jOOQ tip of the day: Thinking of building a query with jOOQ and executing it elsewhere? Think again: https://blog.jooq.org/why-you-should-execute-jooq-queries-with-jooq/

2025-05-10 16:16:15.679 [http-nio-8082-exec-1] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-10 16:16:15.807 [http-nio-8082-exec-1] [] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@d06d5ab
2025-05-10 16:16:15.808 [http-nio-8082-exec-1] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-10 16:16:15.813 [http-nio-8082-exec-1] [] INFO  o.j.i.D.logVersionSupport - Version                  : Database version is supported by dialect POSTGRES: 17.5 (Debian 17.5-1.pgdg120+1)
2025-05-10 16:16:15.847 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Курс загружен: id=49, name='Основы DevOps', departmentId=10
2025-05-10 16:16:15.847 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Запрос лекций из базы данных: courseId=49
2025-05-10 16:16:15.857 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Загружено 2 лекций для курса 'Основы DevOps'
2025-05-10 16:16:15.857 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Запрос ID лекций из Neo4j: semester=1, studyYear=2023
2025-05-10 16:16:15.864 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Выполнение Neo4j запроса:              MATCH (g:Group)-[hs:HAS_SCHEDULE]->(l:Lecture)             WHERE hs.date.year = $year AND (               ($sem = 1 AND hs.date.month >= 9 AND hs.date.month <= 12) OR               ($sem = 2 AND hs.date.month >= 1 AND hs.date.month <= 6)             )             RETURN DISTINCT l.id AS id         , params: {year: 2023, sem: 1}
2025-05-10 16:16:16.364 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Получены ID лекций из Neo4j: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600]
2025-05-10 16:16:16.365 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Найдено 600 лекций, запланированных в семестре 1 года 2023
2025-05-10 16:16:16.365 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Запрос информации об университете из MongoDB: departmentId=10
2025-05-10 16:16:16.369 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Выполнение MongoDB запроса: query=Query: { "institutes.departments.departmentId" : 10}, Fields: {}, Sort: {}
2025-05-10 16:16:16.433 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Получен документ университета: id=681f50ee5c447bbb460109f3, name=РТУ МИРЭА
2025-05-10 16:16:16.433 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Документ университета получен: universityId=null, name='РТУ МИРЭА'
2025-05-10 16:16:16.433 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Определен институт='Институт кибербезопасности', кафедра='Кафедра программной инженерии'
2025-05-10 16:16:16.433 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Отфильтровано 2 лекций для отчета
2025-05-10 16:16:16.433 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Обработка лекции id=97 name='Работа с большими данными (Основы DevOps)'
2025-05-10 16:16:16.433 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Запрос количества студентов из Neo4j: lectureId=97, semester=1, studyYear=2023
2025-05-10 16:16:16.433 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Выполнение Neo4j запроса:              MATCH (l:Lecture {id: $lid})<-[hs:HAS_SCHEDULE]-(g:Group)<-[:BELONGS_TO]-(s:Student)             WHERE hs.date.year = $year AND (               ($sem = 1 AND hs.date.month >= 9 AND hs.date.month <= 12) OR               ($sem = 2 AND hs.date.month >= 1 AND hs.date.month <= 6)             )             RETURN count(DISTINCT s) AS cnt         , params: {sem: 1, year: 2023, lid: 97}
2025-05-10 16:16:16.601 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Получено количество студентов для лекции 97: 150
2025-05-10 16:16:16.602 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Лекция id=97 имеет studentCount=150
2025-05-10 16:16:16.602 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Обработка лекции id=98 name='Алгоритмы и оптимизация (Основы DevOps)'
2025-05-10 16:16:16.602 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Запрос количества студентов из Neo4j: lectureId=98, semester=1, studyYear=2023
2025-05-10 16:16:16.602 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Выполнение Neo4j запроса:              MATCH (l:Lecture {id: $lid})<-[hs:HAS_SCHEDULE]-(g:Group)<-[:BELONGS_TO]-(s:Student)             WHERE hs.date.year = $year AND (               ($sem = 1 AND hs.date.month >= 9 AND hs.date.month <= 12) OR               ($sem = 2 AND hs.date.month >= 1 AND hs.date.month <= 6)             )             RETURN count(DISTINCT s) AS cnt         , params: {sem: 1, year: 2023, lid: 98}
2025-05-10 16:16:16.607 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Получено количество студентов для лекции 98: 150
2025-05-10 16:16:16.608 [http-nio-8082-exec-1] [] DEBUG c.c.lab_2.service.ReportService - [0cb65892] Лекция id=98 имеет studentCount=150
2025-05-10 16:16:16.608 [http-nio-8082-exec-1] [] INFO  c.c.lab_2.service.ReportService - [0cb65892] Отчет успешно сформирован: 2 записей
2025-05-10 16:16:16.609 [http-nio-8082-exec-1] [] INFO  c.c.l.controllers.ReportController - Сформирован отчет, количество записей: 2
2025-05-10 16:16:16.635 [http-nio-8082-exec-1] [] INFO  c.c.l.configs.RequestLoggingFilter - <<< {org.apache.catalina.connector.ResponseFacade@4ce5c725} - {200} ({1289} мс)
2025-05-10 16:16:38.694 [cluster-ClusterId{value='681f517a63663f635d80dc3a', description='null'}-localhost:27017] [] INFO  org.mongodb.driver.cluster - Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoNodeIsRecoveringException: Command failed with error 11600 (InterruptedAtShutdown): 'interrupted at shutdown' on server localhost:27017. The full response is {"ok": 0.0, "errmsg": "interrupted at shutdown", "code": 11600, "codeName": "InterruptedAtShutdown"}
	at com.mongodb.internal.connection.ProtocolHelper.createSpecialException(ProtocolHelper.java:264)
	at com.mongodb.internal.connection.ProtocolHelper.getCommandFailureException(ProtocolHelper.java:206)
	at com.mongodb.internal.connection.InternalStreamConnection.receiveCommandMessageResponse(InternalStreamConnection.java:520)
	at com.mongodb.internal.connection.InternalStreamConnection.receive(InternalStreamConnection.java:469)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.lookupServerDescription(DefaultServerMonitor.java:249)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.run(DefaultServerMonitor.java:176)
2025-05-10 16:16:48.710 [cluster-ClusterId{value='681f517a63663f635d80dc3a', description='null'}-localhost:27017] [] INFO  org.mongodb.driver.cluster - Exception in monitor thread while connecting to server localhost:27017
com.mongodb.MongoSocketOpenException: Exception opening socket
	at com.mongodb.internal.connection.SocketStream.lambda$open$0(SocketStream.java:85)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:85)
	at com.mongodb.internal.connection.InternalStreamConnection.open(InternalStreamConnection.java:233)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.lookupServerDescription(DefaultServerMonitor.java:219)
	at com.mongodb.internal.connection.DefaultServerMonitor$ServerMonitor.run(DefaultServerMonitor.java:176)
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:673)
	at java.base/sun.nio.ch.NioSocketImpl.timedFinishConnect(NioSocketImpl.java:547)
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:590)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:327)
	at java.base/java.net.Socket.connect(Socket.java:666)
	at com.mongodb.internal.connection.SocketStreamHelper.initialize(SocketStreamHelper.java:76)
	at com.mongodb.internal.connection.SocketStream.initializeSocket(SocketStream.java:104)
	at com.mongodb.internal.connection.SocketStream.open(SocketStream.java:79)
	... 3 common frames omitted
2025-05-10 16:17:07.783 [SpringApplicationShutdownHook] [] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-10 16:17:07.785 [tomcat-shutdown] [] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-10 16:17:07.911 [SpringApplicationShutdownHook] [] INFO  o.n.driver.internal.InternalDriver - Closing driver instance 1400585185
2025-05-10 16:17:08.124 [SpringApplicationShutdownHook] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-10 16:17:08.125 [SpringApplicationShutdownHook] [] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
